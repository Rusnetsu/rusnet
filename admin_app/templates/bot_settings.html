<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ ‚Äî –ê–¥–º–∏–Ω–∫–∞</title><link rel="stylesheet" href="/admin_app/static/css/style.css"><style>.settings-container{max-width:1000px;margin:0 auto}.settings-tabs{display:flex;margin-bottom:20px;border-bottom:2px solid #3498db}.settings-tab{padding:12px 24px;background:#f8f9fa;border:none;cursor:pointer;border-radius:6px 6px 0 0;margin-right:5px}.settings-tab.active{background:#3498db;color:white}.settings-content{display:none;padding:20px;background:white;border-radius:0 6px 6px 6px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}.settings-content.active{display:block}.form-group{margin-bottom:20px}.form-group label{display:block;margin-bottom:8px;font-weight:bold;color:#2c3e50}.form-group input,.form-group textarea,.form-group select{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px}.form-group .help-text{font-size:12px;color:#7f8c8d;margin-top:5px}.checkbox-group{display:flex;align-items:center;margin-bottom:15px}.checkbox-group input{width:auto;margin-right:10px}.test-results{margin:15px 0;padding:12px;border-radius:6px;background:#e8f4fd;border:1px solid #b8daff}.test-success{background:#d4edda;border-color:#c3e6cb;color:#155724}.test-error{background:#f8d7da;border-color:#f5c6cb;color:#721c24}.subscription-plans{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin:20px 0}.plan-card{border:2px solid #ddd;border-radius:12px;padding:20px;text-align:center;transition:all 0.3s;background:white}.plan-card:hover{border-color:#3498db;transform:translateY(-5px);box-shadow:0 10px 25px rgba(0,0,0,0.1)}.plan-card.recommended{border-color:#2ecc71;background:#f8fff9;position:relative}.plan-card.popular{border-color:#e74c3c;background:#fff8f8;position:relative}.plan-badge{position:absolute;top:-10px;right:20px;background:#e74c3c;color:white;padding:5px 10px;border-radius:15px;font-size:12px;font-weight:bold}.plan-card.recommended .plan-badge{background:#2ecc71}.plan-name{font-size:20px;font-weight:bold;margin-bottom:10px}.plan-price{font-size:28px;font-weight:bold;color:#2c3e50;margin:15px 0}.plan-period{color:#7f8c8d;font-size:14px}.plan-features{list-style:none;padding:0;margin:15px 0;text-align:left}.plan-features li{padding:6px 0;border-bottom:1px solid #ecf0f1;font-size:14px}.plan-features li:before{content:"‚úÖ ";margin-right:8px}.current-subscription{background:#e8f4fd;padding:20px;border-radius:8px;margin-bottom:20px;border-left:4px solid #3498db}.subscription-active{background:#d4edda;border-left-color:#28a745}.subscription-expired{background:#f8d7da;border-left-color:#dc3545}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;margin-top:15px}.stat-card{text-align:center;padding:10px;background:white;border-radius:6px;box-shadow:0 1px 3px rgba(0,0,0,0.1)}</style></head><body><div class="container"><div style="display:flex;gap:24px">{% include "menu.html" %}<div style="flex:1"><div class="settings-container"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px"><h1>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞: {{ bot.name }}</h1><div style="display:flex;gap:10px;align-items:center"><label for="bot-select" style="font-weight:bold">–¢–µ–∫—É—â–∏–π –±–æ—Ç:</label><select id="bot-select" onchange="switchBot(this.value)" style="padding:8px 12px;border-radius:4px;border:1px solid #ddd">{% for b in bots %}<option value="{{ b.id }}" {% if b.id == current_bot_id %}selected{% endif %}>{{ b.name }} (ID: {{ b.id }})</option>{% endfor %}</select></div></div>{% if request.query_params.get("message") %}<div class="message success">‚úÖ {{ request.query_params.get("message") }}</div>{% endif %}{% if request.query_params.get("test_result") %}<div class="test-results {% if '‚ùå' not in request.query_params.get('test_result') %}test-success{% else %}test-error{% endif %}"><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:</strong> {{ request.query_params.get("test_result") }}</div>{% endif %}<div class="settings-tabs"><button class="settings-tab active" onclick="openTab('basic')">üîß –û—Å–Ω–æ–≤–Ω—ã–µ</button><button class="settings-tab" onclick="openTab('notifications')">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button><button class="settings-tab" onclick="openTab('subscription')">üíé –ü–æ–¥–ø–∏—Å–∫–∞</button></div><div id="basic" class="settings-content active"><form method="post" action="/admin/bot/{{ bot.id }}/settings/update"><div class="form-group"><label>–¢–æ–∫–µ–Ω –±–æ—Ç–∞:</label><input type="text" name="bot_token" value="{{ bot.token }}" placeholder="123456789:ABCdefGhIJKlmNoPQRsTUVwxyZ" style="font-family:monospace"></div><div class="token-help"><a href="https://rusnet.su/2025/10/20/kak-zaregistrirovat-telegram-bota-i-poluchit-ego-api-token/" target="_blank" class="instruction-link">üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é —Ç–æ–∫–µ–Ω–∞</a><div style="margin-top:5px;font-size:11px;color:#888">–¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram –±–æ—Ç–∞. –ü–æ–ª—É—á–∏—Ç–µ —É @BotFather –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å.</div></div><div class="checkbox-group"><input type="checkbox" name="require_phone" id="require_phone" value="on" {% if bot.require_phone == 1 %}checked{% endif %}><label for="require_phone">üìû –¢—Ä–µ–±–æ–≤–∞—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞</label></div><div class="help-text">–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ - –±–æ—Ç –±—É–¥–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ - –±–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞.</div><button type="submit" style="margin-top:20px">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button></form></div><div id="notifications" class="settings-content"><form method="post" action="/admin/bot/{{ bot.id }}/settings/update"><h3>üì± Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3><div class="checkbox-group"><input type="checkbox" name="notify_telegram_enabled" id="notify_telegram_enabled" {% if settings.get('NOTIFY_TELEGRAM_ENABLED') == '1' %}checked{% endif %}><label for="notify_telegram_enabled">–í–∫–ª—é—á–∏—Ç—å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label></div><div class="form-group"><label>Chat ID –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:</label><input type="text" name="notify_chat_id" value="{{ settings.get('NOTIFY_CHAT_ID', '') }}" placeholder="-1001234567890"><div class="help-text">ID —á–∞—Ç–∞ –∏–ª–∏ –∫–∞–Ω–∞–ª–∞ –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –¥–æ–±–∞–≤—å—Ç–µ @userinfobot –≤ –Ω—É–∂–Ω—ã–π —á–∞—Ç.</div></div><h3>üìß Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3><div class="checkbox-group"><input type="checkbox" name="notify_email_enabled" id="notify_email_enabled" {% if settings.get('NOTIFY_EMAIL_ENABLED') == '1' %}checked{% endif %}><label for="notify_email_enabled">–í–∫–ª—é—á–∏—Ç—å Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label></div><div class="form-group"><label>Email –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ (–ª–æ–≥–∏–Ω SMTP):</label><input type="email" name="email_login" value="{{ settings.get('EMAIL_LOGIN', '') }}" placeholder="your-email@example.com"></div><div class="form-group"><label>–ü–∞—Ä–æ–ª—å SMTP:</label><input type="password" name="email_password" value="{% if settings.get('EMAIL_PASSWORD') %}********{% endif %}" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å"><div class="help-text">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º —á—Ç–æ–±—ã –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</div></div><div class="form-group"><label>Email –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:</label><input type="text" name="notify_emails" value="{{ settings.get('NOTIFY_EMAILS', '') }}" placeholder="admin@example.com,manager@example.com"><div class="help-text">–ß–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –Ω–µ—Å–∫–æ–ª—å–∫–æ email –∞–¥—Ä–µ—Å–æ–≤</div></div><div class="form-group"><label>SMTP —Å–µ—Ä–≤–µ—Ä:</label><input type="text" name="smtp_server" value="{{ settings.get('SMTP_SERVER', 'smtp.mail.ru') }}" placeholder="smtp.mail.ru"></div><div class="form-group"><label>SMTP –ø–æ—Ä—Ç:</label><input type="number" name="smtp_port" value="{{ settings.get('SMTP_PORT', '465') }}" placeholder="465"></div><h3>üì± WhatsApp —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3><div class="checkbox-group"><input type="checkbox" name="notify_whatsapp_enabled" id="notify_whatsapp_enabled" {% if settings.get('NOTIFY_WHATSAPP_ENABLED') == '1' %}checked{% endif %}><label for="notify_whatsapp_enabled">–í–∫–ª—é—á–∏—Ç—å WhatsApp —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label></div><div class="form-group"><label>–ù–æ–º–µ—Ä WhatsApp:</label><input type="text" name="whatsapp_number" value="{{ settings.get('WHATSAPP_NUMBER', '') }}" placeholder="79123456789"><div class="help-text">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –ë—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö.</div></div><button type="submit" style="margin-top:20px">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</button></form><div style="margin-top:30px;padding-top:20px;border-top:1px solid #eee"><h3>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3><p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</p><form method="post" action="/admin/bot/{{ bot.id }}/settings/test_notifications" style="display:inline"><button type="submit" class="secondary">üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button></form></div></div><div id="subscription" class="settings-content"><h2>üíé –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π</h2>{% if subscription_info %}<div class="current-subscription {% if subscription_info.is_active %}subscription-active{% else %}subscription-expired{% endif %}"><h3>üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å</h3><div class="stats-grid"><div class="stat-card"><strong>–¢–∞—Ä–∏—Ñ:</strong><br><span style="font-size:16px">{% if subscription_info.plan_type == 'trial' %}üî∞ –ü—Ä–æ–±–Ω—ã–π{% elif subscription_info.plan_type == 'month' %}üìÖ –ú–µ—Å—è—á–Ω—ã–π{% elif subscription_info.plan_type == '3months' %}üóìÔ∏è 3 –º–µ—Å—è—Ü–∞{% elif subscription_info.plan_type == '6months' %}‚è±Ô∏è 6 –º–µ—Å—è—Ü–µ–≤{% elif subscription_info.plan_type == 'year' %}üéâ –ì–æ–¥–æ–≤–æ–π{% else %}{{ subscription_info.plan_type }}{% endif %}</span></div><div class="stat-card"><strong>–°—Ç–∞—Ç—É—Å:</strong><br><span style="font-size:16px;color:{% if subscription_info.is_active %}#28a745{% else %}#dc3545{% endif %}">{% if subscription_info.is_active %}‚úÖ –ê–∫—Ç–∏–≤–Ω–∞{% else %}‚ùå –ù–µ–∞–∫—Ç–∏–≤–Ω–∞{% endif %}</span></div><div class="stat-card"><strong>–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π:</strong><br><span style="font-size:16px;{% if subscription_info.days_remaining < 3 %}color:#dc3545;font-weight:bold{% endif %}">{{ subscription_info.days_remaining }}</span></div><div class="stat-card"><strong>–ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è:</strong><br><span style="font-size:12px">{% if subscription_info.end_date %}{{ subscription_info.end_date }}{% else %}–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ{% endif %}</span></div></div>{% if not subscription_info.is_active %}<div style="margin-top:15px;padding:10px;background:#fff3cd;border-radius:4px"><strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:</strong> –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞. –ë–æ—Ç—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã. –î–ª—è –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ –Ω–∏–∂–µ.</div>{% endif %}</div>{% endif %}<h3>üéØ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã</h3><div class="subscription-plans">{% for plan in plans %}<div class="plan-card {% if plan.id == 'year' %}recommended{% elif plan.id == '3months' %}popular{% endif %}">{% if plan.id == 'year' %}<div class="plan-badge">–†–ï–ö–û–ú–ï–ù–î–£–ï–ú</div>{% elif plan.id == '3months' %}<div class="plan-badge">–ü–û–ü–£–õ–Ø–†–ù–´–ô</div>{% endif %}<div class="plan-name">{{ plan.name }}</div><div class="plan-price">{{ plan.price }} ‚ÇΩ</div><div class="plan-period">{% if plan.period == 'month' %}–≤ –º–µ—Å—è—Ü{% elif plan.period == '3months' %}‚âà {{ (plan.price / 3)|round|int }} ‚ÇΩ/–º–µ—Å—è—Ü{% elif plan.period == '6months' %}‚âà {{ (plan.price / 6)|round|int }} ‚ÇΩ/–º–µ—Å—è—Ü{% elif plan.period == 'year' %}‚âà {{ (plan.price / 12)|round|int }} ‚ÇΩ/–º–µ—Å—è—Ü{% endif %}</div><ul class="plan-features">{% for feature in plan.features %}<li>{{ feature }}</li>{% endfor %}</ul>{% if subscription_info and subscription_info.plan_type == plan.id %}{% if subscription_info.is_active %}<div style="display:flex;gap:10px;flex-direction:column"><button type="button" class="button" style="width:100%;background:#28a745" disabled>‚úÖ –¢–µ–∫—É—â–∏–π</button><form method="get" action="/admin/payment"><input type="hidden" name="plan" value="{{ plan.id }}"><input type="hidden" name="renew" value="true"><button type="submit" class="button" style="width:100%;background:#17a2b8">üîÑ –ü—Ä–æ–¥–ª–∏—Ç—å</button></form></div>{% else %}<form method="get" action="/admin/payment"><input type="hidden" name="plan" value="{{ plan.id }}"><button type="submit" class="button" style="width:100%;{% if plan.id == 'year' %}background:#2ecc71;{% elif plan.id == '3months' %}background:#e74c3c;{% endif %}">–í—ã–±—Ä–∞—Ç—å</button></form>{% endif %}{% else %}<form method="get" action="/admin/payment"><input type="hidden" name="plan" value="{{ plan.id }}"><button type="submit" class="button" style="width:100%;{% if plan.id == 'year' %}background:#2ecc71;{% elif plan.id == '3months' %}background:#e74c3c;{% endif %}">–í—ã–±—Ä–∞—Ç—å</button></form>{% endif %}</div>{% endfor %}</div>{% if stats %}<div style="margin-top:30px;padding:20px;background:#f8f9fa;border-radius:8px"><h3>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h3><div class="stats-grid"><div class="stat-card"><div style="font-size:20px;font-weight:bold;color:#3498db">{{ stats.total_bots }}</div><div style="color:#7f8c8d;font-size:12px">–ë–æ—Ç–æ–≤</div></div><div class="stat-card"><div style="font-size:20px;font-weight:bold;color:#2ecc71">{{ stats.total_interactions }}</div><div style="color:#7f8c8d;font-size:12px">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</div></div><div class="stat-card"><div style="font-size:20px;font-weight:bold;color:#9b59b6">{{ stats.active_days }}</div><div style="color:#7f8c8d;font-size:12px">–î–Ω–µ–π —Å –Ω–∞–º–∏</div></div><div class="stat-card"><div style="font-size:14px;font-weight:bold;color:#f39c12">{% if stats.last_activity %}{{ stats.last_activity }}{% else %}–ù–µ—Ç{% endif %}</div><div style="color:#7f8c8d;font-size:12px">–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div></div></div></div>{% endif %}<div style="text-align:center;margin-top:20px"><a href="/admin/subscription" class="button" style="padding:10px 20px">üìä –ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–æ–π</a></div><div style="margin-top:30px;padding-top:20px;border-top:1px solid #eee"><h3>üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h3><a href="/admin/bot/{{ bot.id }}/analytics" class="button secondary">üìà –°–º–æ—Ç—Ä–µ—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É</a></div></div></div></div></div></div><script>function openTab(tabName){document.querySelectorAll('.settings-content').forEach(tab=>{tab.classList.remove('active');});document.querySelectorAll('.settings-tab').forEach(button=>{button.classList.remove('active');});document.getElementById(tabName).classList.add('active');event.currentTarget.classList.add('active');}function switchBot(botId){window.location.href=`/admin/bot/${botId}/settings`;}document.addEventListener('DOMContentLoaded',function(){const hash=window.location.hash.substring(1);if(hash&&['basic','notifications','subscription'].includes(hash)){openTab(hash);}});</script></body></html>