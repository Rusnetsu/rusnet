<!DOCTYPE html><html><head><meta charset="utf-8"><title>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ‚Äî –ê–¥–º–∏–Ω–∫–∞</title><link rel="stylesheet" href="/admin_app/static/css/style.css"><style>.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin:30px 0}.stat-card{background:white;padding:25px;border-radius:12px;text-align:center;box-shadow:0 4px 6px rgba(0,0,0,0.1);border-left:4px solid #3498db}.stat-number{font-size:2.5em;font-weight:bold;color:#2c3e50;margin-bottom:5px}.stat-label{color:#7f8c8d;font-size:14px}.table-container{background:white;border-radius:10px;padding:20px;margin:20px 0;box-shadow:0 2px 10px rgba(0,0,0,0.1)}.data-table{width:100%;border-collapse:collapse;margin:15px 0}.data-table th,.data-table td{padding:12px;text-align:left;border-bottom:1px solid #ddd}.data-table th{background-color:#f2f2f2;font-weight:bold;color:#2c3e50}.data-table tr:hover{background-color:#f8f9fa}.user-avatar{width:32px;height:32px;border-radius:50%;background:#3498db;display:inline-flex;align-items:center;justify-content:center;color:white;font-weight:bold;margin-right:8px}.subscription-form{display:flex;gap:10px;align-items:center}.subscription-select{padding:6px 10px;border:1px solid #ddd;border-radius:4px;background:white}.update-btn{padding:6px 12px;background:#3498db;color:white;border:none;border-radius:4px;cursor:pointer;font-size:12px}.update-btn:hover{background:#2980b9}.phone-cell{font-family:monospace;font-weight:bold;color:#2c3e50}.no-data{text-align:center;color:#7f8c8d;font-style:italic;padding:40px}.tab-navigation{display:flex;margin-bottom:20px;border-bottom:2px solid #3498db}.tab-button{padding:12px 24px;background:#f8f9fa;border:none;cursor:pointer;border-radius:6px 6px 0 0;margin-right:5px}.tab-button.active{background:#3498db;color:white}.tab-content{display:none}.tab-content.active{display:block}</style></head><body><div class="container"><div style="display:flex;gap:24px">{% include "menu.html" %}<div style="flex:1"><h1>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h1>{% if request.query_params.get("message") %}<div class="message success">‚úÖ {{ request.query_params.get("message") }}</div>{% endif %}<div class="stats-grid"><div class="stat-card"><div class="stat-number">{{ platform_stats[0] or 0 }}</div><div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div></div><div class="stat-card"><div class="stat-number">{{ platform_stats[1] or 0 }}</div><div class="stat-label">–í—Å–µ–≥–æ –±–æ—Ç–æ–≤</div></div><div class="stat-card"><div class="stat-number">{{ platform_stats[2] or 0 }}</div><div class="stat-label">–í—Å–µ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</div></div><div class="stat-card"><div class="stat-number">{{ platform_stats[3] or 0 }}</div><div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π</div></div><div class="stat-card"><div class="stat-number">{{ platform_stats[4] or 0 }}</div><div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º</div></div></div><div class="tab-navigation"><button class="tab-button active" onclick="openTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button><button class="tab-button" onclick="openTab('bots')">ü§ñ –ë–æ—Ç—ã</button><button class="tab-button" onclick="openTab('activity')">üìà –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</button></div><div id="users" class="tab-content active"><div class="table-container"><h2>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h2>{% if users_stats %}<table class="data-table"><thead><tr><th>ID</th><th>–ò–º—è</th><th>Username</th><th>–¢–µ–ª–µ—Ñ–æ–Ω</th><th>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</th><th>–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</th><th>–ë–æ—Ç–æ–≤</th><th>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</th><th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th><th>–¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ</th><th>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π</th></tr></thead><tbody>{% for user in users_stats %}<tr><td>{{ user.user_id }}</td><td><div style="display:flex;align-items:center"><div class="user-avatar">{{ user.first_name[0] if user.first_name else '?' }}</div>{{ user.first_name }} {{ user.last_name or '' }}</div></td><td>@{{ user.username or '‚Äî' }}</td><td class="phone-cell">{{ user.phone or '‚Äî' }}</td><td>{{ user.registration_date[:10] if user.registration_date else '‚Äî' }}</td><td>{{ user.last_login[:10] if user.last_login else '‚Äî' }}</td><td>{{ user.bot_count }}</td><td>{{ user.interaction_count or 0 }}</td><td>{% if user.last_activity %}{{ user.last_activity[:16] }}{% else %}–ù–µ—Ç{% endif %}</td><td>{{ user.current_plan or '–ù–µ—Ç' }}</td><td><form class="subscription-form" method="post" action="/admin/platform/update_subscription"><input type="hidden" name="user_id" value="{{ user.user_id }}"><select name="plan_type" class="subscription-select"><option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ ‚Äî</option>{% for plan in plans %}<option value="{{ plan.id }}" {% if user.current_plan==plan.id %}selected{% endif %}>{{ plan.name }}</option>{% endfor %}</select><button type="submit" class="update-btn">üíæ</button></form></td></tr>{% endfor %}</tbody></table>{% else %}<div class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö</div>{% endif %}</div></div><div id="bots" class="tab-content"><div class="table-container"><h2>ü§ñ –ë–æ—Ç—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h2>{% if bots_stats %}<table class="data-table"><thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–í–ª–∞–¥–µ–ª–µ—Ü</th><th>–¢–µ–ª–µ—Ñ–æ–Ω –≤–ª–∞–¥–µ–ª—å—Ü–∞</th><th>–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</th><th>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</th><th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th><th>–°–æ–∑–¥–∞–Ω</th></tr></thead><tbody>{% for bot in bots_stats %}<tr><td>{{ bot.id }}</td><td>{{ bot.name }}</td><td>{{ bot.owner_name }}{% if bot.owner_username %}(@{{ bot.owner_username }}){% endif %}</td><td class="phone-cell">{{ bot.owner_phone or '‚Äî' }}</td><td>{{ bot.unique_users or 0 }}</td><td>{{ bot.total_interactions or 0 }}</td><td>{% if bot.last_activity %}{{ bot.last_activity[:16] }}{% else %}–ù–µ—Ç{% endif %}</td><td>{{ bot.created_at[:10] if bot.created_at else '‚Äî' }}</td></tr>{% endfor %}</tbody></table>{% else %}<div class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –±–æ—Ç–∞—Ö</div>{% endif %}</div></div><div id="activity" class="tab-content"><div class="table-container"><h2>üìà –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>{% if recent_activities %}<table class="data-table"><thead><tr><th>–î–∞—Ç–∞</th><th>–¢–∏–ø</th><th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th><th>–¢–µ–ª–µ—Ñ–æ–Ω</th><th>–ë–æ—Ç</th><th>–í–ª–∞–¥–µ–ª–µ—Ü</th></tr></thead><tbody>{% for activity in recent_activities %}<tr><td>{{ activity.interaction_date[:16] if activity.interaction_date else '‚Äî' }}</td><td>{{ activity.interaction_type }}</td><td>{{ activity.first_name or '‚Äî' }}{% if activity.username %}(@{{ activity.username }}){% endif %}</td><td class="phone-cell">{{ activity.phone or '‚Äî' }}</td><td>{{ activity.bot_name }}</td><td>{{ activity.owner_name }}</td></tr>{% endfor %}</tbody></table>{% else %}<div class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>{% endif %}</div></div></div></div></div><script>function openTab(tabName){const tabContents=document.getElementsByClassName('tab-content');for(let i=0;i<tabContents.length;i++){tabContents[i].classList.remove('active');}const tabButtons=document.getElementsByClassName('tab-button');for(let i=0;i<tabButtons.length;i++){tabButtons[i].classList.remove('active');}document.getElementById(tabName).classList.add('active');event.currentTarget.classList.add('active');}document.addEventListener('DOMContentLoaded',function(){const forms=document.querySelectorAll('.subscription-form');forms.forEach(form=>{form.addEventListener('submit',function(e){e.preventDefault();const formData=new FormData(this);const submitBtn=this.querySelector('.update-btn');const originalText=submitBtn.textContent;submitBtn.disabled=true;submitBtn.textContent='...';fetch(this.action,{method:'POST',body:formData}).then(response=>{if(response.redirected){window.location.href=response.url;}else{return response.json();}}).then(data=>{if(data&&data.success){alert('‚úÖ –¢–∞—Ä–∏—Ñ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω');location.reload();}}).catch(error=>{console.error('Error:',error);alert('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞');}).finally(()=>{submitBtn.disabled=false;submitBtn.textContent=originalText;});});});});</script></body></html>