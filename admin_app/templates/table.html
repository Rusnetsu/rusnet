{% if items %}<div id="floating-actions" style="display:none;position:fixed;bottom:20px;right:20px;background:#fff;padding:15px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:1000;border:1px solid #ddd"><div style="display:flex;gap:10px;align-items:center"><strong>Выбрано: <span id="selected-count">0</span></strong><button onclick="saveSelected()" class="button" style="padding:8px 12px">💾 Сохранить выбранные</button><button onclick="deleteSelected()" class="button delete" style="padding:8px 12px">🗑️ Удалить выбранные</button><button onclick="clearSelection()" class="button secondary" style="padding:8px 12px">❌ Сбросить</button></div></div><table><tr><th style="width:40px"><input type="checkbox" id="select-all" onchange="toggleAllSelection(this.checked)"></th><th>Пункт меню</th></tr>{% for item in items %}<tr id="row-{{ item.id }}" data-item-id="{{ item.id }}"><td><input type="checkbox" class="item-checkbox" value="{{ item.id }}" onchange="updateSelection()"></td><td><form class="edit-form" data-id="{{ item.id }}" enctype="multipart/form-data"><input type="hidden" name="id" value="{{ item.id }}"><div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:15px;padding:15px;background:#f8f9fa;border-radius:6px"><div style="flex:1"><strong style="display:block;margin-bottom:8px;font-size:16px">📝 Название пункта:</strong><input name="title" value="{{ item.title }}" style="width:100%;font-size:14px;padding:8px" onchange="markAsChanged({{ item.id }})" placeholder="Введите название пункта меню"></div><div style="display:flex;gap:8px;margin-left:15px"><button type="button" onclick="saveSingleItem({{ item.id }})" class="save-btn" style="padding:8px 12px">💾 Сохранить</button><button type="button" onclick="deleteSingleItem({{ item.id }})" class="delete" style="padding:8px 12px">❌ Удалить</button></div></div><div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:15px;margin-bottom:15px"><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">📂 Раздел:</strong><select name="parent_key" onchange="markAsChanged({{ item.id }})" style="width:100%"><option value="">— Основное меню —</option>{% for filter in parent_filters %}{% if filter.key and filter.key != '' and filter.key != item.key %}<option value="{{ filter.key }}" {% if item.parent_key==filter.key %}selected{% endif %}>{{ filter.display_title|safe }}</option>{% endif %}{% endfor %}</select></div><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">💰 Цена:</strong><input name="price" value="{{ item.price or '' }}" style="width:100%" onchange="markAsChanged({{ item.id }})" placeholder="от 5 000 ₽"></div><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">🔢 Порядок:</strong><input type="number" name="sort_order" value="{{ item.sort_order }}" style="width:100%" onchange="markAsChanged({{ item.id }})" min="0"></div></div><div style="margin-bottom:15px;padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">📄 Описание:</strong><textarea name="description" rows="3" style="width:100%" onchange="markAsChanged({{ item.id }})" placeholder="Описание услуги или товара">{{ item.description or '' }}</textarea></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px"><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">🖼️ Изображение/Видео:</strong><input type="file" name="image" accept="image/*,video/*" onchange="markAsChanged({{ item.id }})" style="width:100%">{% if item.image_path %}<div style="margin-top:8px"><small>Текущее: {{ item.image_path }}</small><br><label><input type="checkbox" name="remove_image" value="1"> Удалить изображение</label></div>{% endif %}</div><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">📎 Файл для скачивания:</strong><input type="file" name="file" onchange="markAsChanged({{ item.id }})" style="width:100%">{% if item.file_path %}<div style="margin-top:8px"><small>Текущее: {{ item.file_path }}</small><br><label><input type="checkbox" name="remove_file" value="1"> Удалить файл</label></div>{% endif %}</div></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:15px"><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">🔄 Тип кнопки:</strong><select name="button_type" onchange="markAsChanged({{ item.id }})" style="width:100%"><option value="reply" {% if item.button_type=='reply' %}selected{% endif %}>📋 Основное меню</option><option value="inline" {% if item.button_type=='inline' %}selected{% endif %}>📱 Встроенная кнопка</option></select></div><div style="padding:12px;background:#f8f9fa;border-radius:4px"><strong style="display:block;margin-bottom:8px">🎯 Действие:</strong><select name="action" onchange="markAsChanged({{ item.id }})" style="width:100%"><option value="none" {% if not item.action or item.action=='none' %}selected{% endif %}>ℹ️ Показать информацию</option><option value="order" {% if item.action=='order' %}selected{% endif %}>🛒 Отправить заявку</option><option value="download" {% if item.action=='download' %}selected{% endif %}>📥 Скачать файл</option></select></div></div></form></td></tr>{% endfor %}</table>{% else %}<p class="empty">Нет пунктов меню. Добавьте первый через форму выше.</p>{% endif %}